# I2C 통신이란?
+ Inter-Integrated Circut(I2C)는 IC 사이 통신 링크를 제공하는 양방향 2와이어 직렬 버스 이다
  + 두가닥으로 직렬 통신을 하는 통신프로토콜
+ 구성
  + 하나의 마스터와, 다른 하나의 슬레이브로 구성
  + 슬레이브는 127개까지 구성이 가능
    + 메인 *ECU가 있으면, 그 외 여러가지 디바이스들이 묶여 통신이 가능 
![image](https://github.com/user-attachments/assets/410156f1-cf76-48b1-b867-be438975a455)

### SDA
+ 데이터를 주고 받기 위한 선

### SCL
+ 타이밍을 동기화 하기 위한 클럭 선

## 주의할 점
![image](https://github.com/user-attachments/assets/7a5ba25c-b68f-4f80-a2e2-b650a064c2aa)
+ 풀업 저항(위 그림의 Rp 두개)
  + 저항을 다는 이유
    + I2C 통신을 위해 SDA선과 SCL 선이 모두 기본으로 High 상태가 되어야 한다. 풀업 저항은 이를 High 상태로 만들어 줌
      + 아두이노 사용 한다면 이는 내부 풀업 저항을 사용 하기 때문에 직접 달아 줄 필요 X
    + 한가닥의 선으로 *Tx, Rx를 하기 때문에 Floating 현상이 발생 함을 방지 하기 위해 풀업 저항을 달기도 함


+ 데이터를 전송 또는 수신 할건지는 마스터에서 주도한다. 그리고 데이터를 송/수신 할때 반드시 슬레이브 주소를 마스터에 명시 해 두어야 통신이 된다.

## UART 대비 좋은점
+ UART와 비교 해보면, I2C는 동기화 통신 방식이라는 것이다. 동기화 통신 방식이란 Clock 신호를 이용해서 데이터를 얼마나 보내는지 타이밍을 맞춘다. 이는 시리얼 통신처럼 통신속도(Baudrate)를 따로 정해주지 않아도 된다는 점이 있다

# I2C 데이터 통신
![image](https://github.com/user-attachments/assets/10a88d49-5a45-4e7a-8112-481d72733dd8)

1. SDA와 SCL은 위에서 잠깐 언급한거와 마찬가지로 풀업저항에 의해 기본 High
2. SCA신호가 LOW로 떨어질때가 시작 신호(S)라고 판단
3. 클럭 신호가 High 일때가 SDA 신호를 읽는 시간
4. SCL 신호가 Low(녹색)가 되면 비트신호로 바꾸고 다시 High(파란색)가 되면 다시 읽고. 이렇게 반복

5. 모든 비트의 전송이 끝난 후 SCL 신호가 High가 되면 SDA 신호 역시 High로 되어 정지 신호(P)를 만듦

+ 시작 신호 뒤 나오는 첫 7비트는 슬레이브의 주소값이다. 8번째 비트는 데이터를 읽어올지 또는 쓸지를 나타내는 신호 비트이다.


# I2C 쓰기/읽기
+ 슬레이브의 주소 값과 읽기/쓰기 비트는 마스터에서 생성 가능하다.
  + 쓰기의 경우엔 마스터에서 데이터를 생성 해야 한다.
  + 읽기의 경우엔 슬레이브에서 데이터를 생성 해야 한다. 8비트 데이터 전송 후 슬레이브에서 응답신호(ACK)를 만들어 수신을 확인해준다.
+ 응답 신호는 기본적으로 LOW여야 하며 만일 슬레이브가 데이터를 전송 하는 상태에서 모든 데이터의 전송이 끝났다면, High 상태로 바뀐다. 이를 NACK 라고 한다. 그 외 *NACK가 생기면 통신 에러 또는 데이터의 에러이다.

#
#### ECU
+ 전자제어유닛(Electronic Control Unit)
#### Tx, Rx
+ Rx는 수신(Receive), Tx는 송신(Transmit)을 의미
#### NACK
+ 부정 응답 문자(negative acknowledgement code, NACK)

#
#### 참고자료
+ https://mickael-k.tistory.com/184
